(window.webpackJsonp=window.webpackJsonp||[]).push([[40,75],{106:function(e,o,r){"use strict";r.r(o);r(2),r(7),r(70);angular.module("graphdb.framework.jmx.queries",["toastr","ui.bootstrap","graphdb.framework.jmx.queries.controllers","graphdb.framework.core.directives"])},70:function(e,o,r){"use strict";r.r(o);r(2),r(11);const t=angular.module("graphdb.framework.jmx.queries.controllers",["ui.bootstrap","toastr","graphdb.framework.rest.monitoring.service"]);t.controller("QueriesCtrl",["$scope","$modal","toastr","$interval","$repositories","$jwtAuth","ModalService","MonitoringRestService",function(e,o,r,t,n,i,s,u){e.loader=!0,e.stringLimit=500,e.expanded={},e.jolokiaError="";const c=document.createElement("a");e.parseNode=function(e){if(null==e)return null;let o="local";if(e.indexOf("://localhost:")<0&&e.indexOf("://localhost/")<0){c.href=e;let r=c.hostname;(function(e){const o=e.split(".");for(let e=0,r=0;e<o.length;e++)if(parseInt(o[e],10)>=0&&parseInt(o[e],10)<=255?r++:r=0,4===r)return!0;return!1})(c.hostname)||(r=c.hostname.split(".")[0]),o=r+":"+c.port}const r=e.match(/\/repositories\/([^\/]+)#(\d+)/);return[r[2],o,r[1]]},e.getQueries=function(){e.getQueriesRunning||e.paused||e.jolokiaError||!n.getActiveRepository()||(e.getQueriesRunning=!0,u.monitorQuery().success((function(o){const r=o;e.noQueries=0===r.length,e.queries={};for(let o=0;o<r.length;o++)r[o].parsedNode=e.parseNode(r[o].node),e.queries[r[o].trackId]=r[o];e.noActiveRepository=!1,e.loader=!1,e.getQueriesRunning=!1})).error((function(o){e.jolokiaError=getError(o),e.loader=!1,e.getQueriesRunning=!1})))};const a=t((function(){n.isActiveRepoOntopType()||e.getQueries()}),1e3);e.$on("$destroy",(function(){t.cancel(a)})),e.deleteQueryHttp=function(o){e.loader=!0,u.deleteQuery(o).success((function(){r.success("Abort request sent."),e.loader=!1})).error((function(o){const t=getError(o);r.error(t,"Error"),e.loader=!1}))},e.abortQuery=function(o){s.openSimpleModal({title:"Confirm abort",message:"Are you sure you want to abort the query?",warning:!0}).result.then((function(){e.deleteQueryHttp(o)}))},e.downloadQuery=function(e){const o="query_"+e+".rq";let r="rest/monitor/query/download?queryId="+encodeURIComponent(e)+"&repository="+encodeURIComponent(n.getActiveRepository())+"&filename="+encodeURIComponent(o);i.isAuthenticated()&&(r=r+"&authToken="+encodeURIComponent(i.getAuthToken())),window.open(r,"_blank")},e.toggleQueryExpanded=function(o){e.expanded[o]=!e.expanded[o]}}]),t.controller("DeleteQueryCtrl",["$scope","$modalInstance",function(e,o){e.ok=function(){o.close()},e.cancel=function(){o.dismiss("cancel")}}])}}]);
//# sourceMappingURL=40.74c838eab6b84d9eceea.bundle.js.map