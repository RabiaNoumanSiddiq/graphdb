(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{70:function(e,o,n){"use strict";n.r(o);n(2),n(11);const t=angular.module("graphdb.framework.jmx.queries.controllers",["ui.bootstrap","toastr","graphdb.framework.rest.monitoring.service"]);t.controller("QueriesCtrl",["$scope","$modal","toastr","$interval","$repositories","$jwtAuth","ModalService","MonitoringRestService",function(e,o,n,t,r,i,s,u){e.loader=!0,e.stringLimit=500,e.expanded={},e.jolokiaError="";const c=document.createElement("a");e.parseNode=function(e){if(null==e)return null;let o="local";if(e.indexOf("://localhost:")<0&&e.indexOf("://localhost/")<0){c.href=e;let n=c.hostname;(function(e){const o=e.split(".");for(let e=0,n=0;e<o.length;e++)if(parseInt(o[e],10)>=0&&parseInt(o[e],10)<=255?n++:n=0,4===n)return!0;return!1})(c.hostname)||(n=c.hostname.split(".")[0]),o=n+":"+c.port}const n=e.match(/\/repositories\/([^\/]+)#(\d+)/);return[n[2],o,n[1]]},e.getQueries=function(){e.getQueriesRunning||e.paused||e.jolokiaError||!r.getActiveRepository()||(e.getQueriesRunning=!0,u.monitorQuery().success((function(o){const n=o;e.noQueries=0===n.length,e.queries={};for(let o=0;o<n.length;o++)n[o].parsedNode=e.parseNode(n[o].node),e.queries[n[o].trackId]=n[o];e.noActiveRepository=!1,e.loader=!1,e.getQueriesRunning=!1})).error((function(o){e.jolokiaError=getError(o),e.loader=!1,e.getQueriesRunning=!1})))};const a=t((function(){r.isActiveRepoOntopType()||e.getQueries()}),1e3);e.$on("$destroy",(function(){t.cancel(a)})),e.deleteQueryHttp=function(o){e.loader=!0,u.deleteQuery(o).success((function(){n.success("Abort request sent."),e.loader=!1})).error((function(o){const t=getError(o);n.error(t,"Error"),e.loader=!1}))},e.abortQuery=function(o){s.openSimpleModal({title:"Confirm abort",message:"Are you sure you want to abort the query?",warning:!0}).result.then((function(){e.deleteQueryHttp(o)}))},e.downloadQuery=function(e){const o="query_"+e+".rq";let n="rest/monitor/query/download?queryId="+encodeURIComponent(e)+"&repository="+encodeURIComponent(r.getActiveRepository())+"&filename="+encodeURIComponent(o);i.isAuthenticated()&&(n=n+"&authToken="+encodeURIComponent(i.getAuthToken())),window.open(n,"_blank")},e.toggleQueryExpanded=function(o){e.expanded[o]=!e.expanded[o]}}]),t.controller("DeleteQueryCtrl",["$scope","$modalInstance",function(e,o){e.ok=function(){o.close()},e.cancel=function(){o.dismiss("cancel")}}])}}]);
//# sourceMappingURL=75.a24e6ff0de052c1e4a8f.bundle.js.map